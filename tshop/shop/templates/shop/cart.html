<!DOCTYPE html>
<html>
<head>
    <title>Your Cart</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'shop/styles.css' %}">
</head>
<body>
    <header>
        <h1><a href="{% url 'shop:index' %}">SHOP</a></h1>
        <nav>
            <ul>
                {% if request.session.customer_id %}
                    <li><a href="{% url 'shop:logout' %}">로그아웃</a></li>
                {% else %}
                    <li><a href="{% url 'shop:customer_login' %}">Login</a></li>
                    <li><a href="{% url 'shop:business_signup' %}">Business Signup</a></li>
                    <li><a href="{% url 'shop:customer_signup' %}">Customer Signup</a></li>
                {% endif %}
            </ul>
        </nav>
    </header>

    <main>
        <section>
            <h2>Current Address</h2>
            {% if address %}
                <p>Street Address: {{ address.street_address }}</p>
                <p>City: {{ address.city }}</p>
                <p>State: {{ address.state }}</p>
                <p>Country: {{ address.country }}</p>
                <p>Postal Code: {{ address.postal_code }}</p>
            {% else %}
                <p>No address available.</p>
            {% endif %}
        </section>

        <section>
            <h2>Update Address</h2>
            <form method="post">
                {% csrf_token %}
                {{ address_form.as_p }}
                <button type="submit">Update Address</button>
            </form>
        </section>

        <section>
            <h2>Your Cart</h2>
            <div class="cart-list">
                {% for item in cart_items %}
                <div class="cart-item">
                    <h3>{{ item.product.product_name }}</h3>
                    <p>가격: ${{ item.product.price }}</p>
                    <p>개수: {{ item.quantity }}</p>
                    <a href="{% url 'shop:update_cart_quantity' item.id 'increase' %}">+</a>
                    <a href="{% url 'shop:update_cart_quantity' item.id 'decrease' %}">-</a>
                    <a href="{% url 'shop:update_cart_quantity' item.id 'delete' %}">Remove</a>
                </div>
                {% empty %}
                    <p>장바구니가 비어 있습니다.</p>
                {% endfor %}
            </div>
            <form id="purchase-form" method="post" action="{% url 'shop:purchase' %}" onsubmit="return confirmPurchase();">
                {% csrf_token %}
                <button type="submit">Checkout</button>
            </form>
        </section>

        <section>
            <h2>Your Orders</h2>
            <div class="cart-list">
                {% for order in orders %}
                <div class="order-item">
                    <h3 class="item-name">{{ order.product.product_name }}</h3>
                    <p class="item-quantity">개수: {{ order.quantity }}</p>
                    <p class="order-date">주문 일: {{ order.order_date }}</p>
                </div>
                {% empty %}
                    <p>주문이 비어 있습니다.</p>
                {% endfor %}
            </div>
        </section>
    </main>

    <script>
        function confirmPurchase() {
            return confirm("구매 하시겠습니까?");
        }
    </script>

    <footer>
        <p>&copy; 2024 Tshop. All rights reserved.</p>
    </footer>
</body>
</html>
